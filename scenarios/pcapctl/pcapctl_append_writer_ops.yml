meta:
    name: "pcapctl dumping with standard writer_ops and then with append to the same file."
harbours: []
tasks:
  - boot
  - name: Starting the dumping to file data.pcap.
    command:
      args: "pcapctl --start --device=0 --ops=0 --outfile=/tmp/data.pcap"
      assert: "Start dumping on device - 0, ops - 0."
  - name: Ping 8.8.8.8 must go to /tmp/data.pcap.
    command: "ping 8.8.8.8"
  - name: Checking the file has size 332B
    command:
      args: " ls -e /tmp"
      assert: "332"
  - name: Stopping dumping.
    command:
      args: "pcapctl --stop --device=0"
      assert: "Stop dumping on device - 0."
  - name: Ping 8.8.8.8 again, file /tmp/data.pcap should not change.
    command: "ping 8.8.8.8"
  - name: Checking file has the same size.
    command:
      args: " ls -e /tmp"
      assert: "332"
  - name: Start dumping with differente writer ops
    command:
      args: "pcapctl --start --device=0 --ops=2 --force --outfile=/tmp/data.pcap"
      assert: "Start dumping on device - 0, ops - 2."
  - name: Ping 8.8.8.8 again, sholud be dumped to /tmp/data.pcap but without header file.
    command:
      args: "ping 8.8.8.8"
  - name: Assert size of file is 332B + request/answer to ping (which is 484).
    command:
      args: " ls -e /tmp"
      assert: "484"
  - name: Stop dumping.
    command:
      args: "pcapctl --stop --device=0"
      assert: "Stop dumping on device - 0."
