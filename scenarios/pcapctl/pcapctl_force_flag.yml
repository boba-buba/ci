meta:
  name: "pcapctl trying start dumpin g to already existing file."
  harbours: []
tasks:
  - boot
  - name: Create empty file.
    command:
      args: "mkfile /tmp/data.pcap"
  - name: Assert file exists.
    command:
      args: "ls /tmp"
      assert: "data.pcap"
  - name: Assert file is empty.
    command:
      args: " ls -e /tmp"
      assert: "0"
  - name: Starting the dumping to file data.pcap.
    command:
      args: "pcapctl --start --device=0 --ops=0 --outfile=/tmp/data.pcap"
      assert: "File /tmp/data.pcap already exists. If you want to overwrite it, then use flag --force."
  - name: Start dumping with force flag.
    command:
      args: "pcapctl --start --device=0 --ops=0 --force --outfile=/tmp/data.pcap"
  - name: Ping 8.8.8.8 must go to /tmp/data.pcap.
    command: "ping 8.8.8.8"
  - name: Checking the file has size 332B
    command: 
      args: " ls -e /tmp"
      assert: "332"
  - name: Stopping dumping.
    command:
      args: "pcapctl -t -d 0"
  - name: Ping 8.8.8.8 again, file /tmp/data.pcap should not change.
    command: "ping 8.8.8.8"
  - name: Checking file has the same size.
    command:
      args: " ls -e /tmp"
      assert: "332"
